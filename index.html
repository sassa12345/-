<!DOCTYPE html>
<html>
<head>
<title>MP3 Player</title>
<style>
  body {
    font-family: sans-serif;
  }
  #player {
    width: 300px;
    padding: 20px;
    border: 1px solid #ccc;
  }
  button {
    margin: 5px;
  }
</style>
</head>
<body>
<div id="player">
  <audio id="audio" controls>
    Your browser does not support the audio element.
  </audio>
  <button onclick="playRandom()">Random Play</button>
  <button onclick="stop()">Stop</button>
  <button onclick="next()">Next</button>
  <button onclick="prev()">Previous</button>
  <button onclick="showAnswer()">Answer</button>
</div>

<script>
  const audio = document.getElementById('audio');
  let mp3Files = []; // MP3ファイルのリスト

  // HTMLファイルと同じディレクトリにあるMP3ファイルを読み込む
  fetch('./') // 現在のディレクトリを指定
    .then(response => response.text())
    .then(html => {
      const parser = new DOMParser();
      const doc = parser.parseFromString(html, 'text/html');
      const links = doc.querySelectorAll('a'); // すべてのリンクを取得

      links.forEach(link => {
        const href = link.getAttribute('href');
        if (href.endsWith('.mp3')) { // MP3ファイルかどうかを確認
          mp3Files.push(href);
        }
      });

      // MP3ファイルが読み込まれたら、ランダム再生を開始
      playRandom();
    });

  let currentTrack = 0;

  function playRandom() {
    currentTrack = Math.floor(Math.random() * mp3Files.length);
    audio.src = mp3Files[currentTrack];
    audio.play();
  }

  function stop() {
    audio.pause();
  }

  function next() {
    currentTrack = (currentTrack + 1) % mp3Files.length;
    audio.src = mp3Files[currentTrack];
    audio.play();
  }

  function prev() {
    currentTrack = (currentTrack - 1 + mp3Files.length) % mp3Files.length;
    audio.src = mp3Files[currentTrack];
    audio.play();
  }

  function showAnswer() {
    const audioSrc = audio.src;
    const fileName = audioSrc.substring(audioSrc.lastIndexOf('/') + 1); // ファイル名を取得
    alert("再生中の曲: " + fileName);
  }
</script>
</body>
</html>
